@startuml
!theme plain
skinparam shadowing false
skinparam roundcorner 8
skinparam linetype ortho

title Диаграмма активностей обработки данных EcoGuardian

start
:Сбор показаний датчиков;
:Валидация пакетов;
if (Пакет корректен?) then (да)
  :Агрегация по окну;
  :Обогащение контекстом;
  :Детекция аномалий;
  if (Аномалия обнаружена?) then (да)
    :Фиксация инцидента;
    :Оценка критичности;
  else (нет)
    :Подготовка признаков\nдля прогноза;
  endif
  :Загрузка активной ML-модели;
  :Генерация прогноза и риска;
  if (Риск высокий?) then (да)
    :Формирование оповещения;
    :Маршрутизация уведомлений;
  else (нет)
    :Обновление дашборда\nв реальном времени;
  endif
  :Сохранение результатов\n(аномалии, прогнозы, оповещения);
else (нет)
  :Логирование ошибки\nи запрос повтора;
endif
stop

@enduml

